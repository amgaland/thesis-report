% Дипломын ажлын загвар 
% Хөгжүүлэгч М.Золжаргал, Г.Амарсанаа
% Монгол Улсын Их Сургуулийн Мэдээлэл Компьютерийн Ухааны Тэнхимийн шаардлагад нийцүүлэв

\geometry{left=3cm,right=2cm,top=2.5cm,bottom=2cm,includefoot}

% Define spacing commands for 12pt fonts
\newcommand{\doublespace}{\renewcommand{\baselinestretch}{1.66}\small\normalsize}
\newcommand{\oneandhalfspace}{\renewcommand{\baselinestretch}{1.24}\small\normalsize}
\newcommand{\singlespace}{\renewcommand{\baselinestretch}{0.9}\small\normalsize}
\singlespace

% Нүүр хуудас
\title{\tt$\backslash$\string @title}
\newcommand{\titleEng}[1]{\newcommand{\@titleEng}{#1}}
\author{\tt$\backslash$\string author}
\newcommand{\authorShort}[1]{\newcommand{\@authorShort}{#1}}
\newcommand{\defensemonth}[1]{\renewcommand{\@defensemonth}{#1}}
\newcommand{\@defensemonth}{\tt$\backslash$\string defensemonth}
\newcommand{\gradmonth}[1]{\renewcommand{\@gradmonth}{#1}}
\newcommand{\@gradmonth}{\tt$\backslash$\string gradmonth}
\newcommand{\gradyear}[1]{\renewcommand{\@gradyear}{#1}}
\newcommand{\@gradyear}{\tt$\backslash$\string gradyear}
\newcommand{\supervisor}[1]{\newcommand{\@supervisor}{#1}}
\newcommand{\cosupervisor}[1]{\newcommand{\@cosupervisor}{#1}}
\newcommand{\chair}[1]{\renewcommand{\@chair}{#1}}
\newcommand{\@chair}{\tt$\backslash$\string chair}
\newcommand{\memberOne}[1]{\renewcommand{\@memberOne}{#1}}
\newcommand{\@memberOne}{\tt$\backslash$\string memberOne}
\newcommand{\memberTwo}[1]{\renewcommand{\@memberTwo}{#1}}
\newcommand{\@memberTwo}{\tt$\backslash$\string memberTwo}
\newcommand{\memberThree}[1]{\renewcommand{\@memberThree}{#1}}
\newcommand{\@memberThree}{\tt$\backslash$\string memberThree}
\newcommand{\memberFour}[1]{\renewcommand{\@memberFour}{#1}}
\newcommand{\@memberFour}{\tt$\backslash$\string memberFour}
\newcommand{\degreeName}[1]{\newcommand{\@degreeName}{#1}}
\newcommand{\programeName}[1]{\newcommand{\@programeName}{#1}}
\newcommand{\paperType}[1]{\renewcommand{\@paperType}{#1}}
\newcommand{\@paperType}{\tt$\backslash$\string paperType}
\newcommand{\cityName}[1]{\renewcommand{\@cityName}{#1}}
\newcommand{\@cityName}{\tt$\backslash$\string cityName}
\newcommand{\university}[1]{\renewcommand{\@university}{#1}}
\newcommand{\@university}{\tt$\backslash$\string university}
\newcommand{\faculty}[1]{\newcommand{\@faculty}{#1}}
\newcommand{\department}[1]{\renewcommand{\@department}{#1}}
\newcommand{\@department}{\tt$\backslash$\string department}
\newcommand{\sisiId}[1]{\newcommand{\@sisiId}{#1}}

% Redefine maketitle
\newlength{\fiveblanklines}\setlength{\fiveblanklines}{0.7in}
\newlength{\tenblanklines}\setlength{\tenblanklines}{1.5in}

\newcommand\makefrontpage{
	\enlargethispage{0.5in}
	\thispagestyle{empty}
	\noindent
	\begin{minipage}[t][647.0truept][t]{\linewidth}
		\begin{center}
			\textbf{\@university} \\
			\textbf{\@faculty} \\
			\textbf{\@department}
		\end{center}
		\vspace{\tenblanklines}
		\begin{center}
			\large{\@author}
		\end{center}
		\vspace{\fiveblanklines}
		\begin{center}
			\singlespace
			\begin{LARGE}
				\textbf{\@title}
			\end{LARGE}
			\\ \ \\
			\begin{Large}
				\textbf{(\@titleEng)}
			\end{Large}
			\\ \ \\
			\@programeName
			\@degreeName
		\end{center}
		\vspace{\tenblanklines}
		\vfill
		\begin{center}
			\doublespace
			\@cityName \\
			\@gradyear
		\end{center}
	\end{minipage}
	\clearpage
}

\renewcommand\maketitle{
	\enlargethispage{0.5in}
	\setcounter{page}{0}
	\thispagestyle{empty}
	\begin{minipage}[t][647.0truept][t]{\linewidth}
		\begin{center}
			\textbf{\@university} \\
			\textbf{\@faculty} \\
			\textbf{\@department}
		\end{center}
		\vspace{\tenblanklines}
		\begin{center}
			\singlespace
			\begin{Large}
				\textbf{\@title}
			\end{Large}
			\\ \ \\
			\begin{Large}
				\textbf{(\@titleEng)}
			\end{Large}
			\\ \ \\
			\@programeName
			\@degreeName
		\end{center}
		\vspace{\tenblanklines}
		\begin{tabular}{m{4cm} m{4cm} m{15cm}}
			Удирдагч:    & \underline{\hspace{4cm}} & \@supervisor \\
			\\
			Гүйцэтгэсэн: & \underline{\hspace{4cm}} & \@authorShort \  (\@sisiId)
		\end{tabular}
		\vfill
		\begin{center}
			\doublespace
			\@cityName \\
			\@gradyear
		\end{center}
	\end{minipage}
	\clearpage
}

% Redefine abstract environment
\renewenvironment{abstract}{
	\addcontentsline{toc}{part}{УДИРТГАЛ}
	\begin{center}
		\doublespace
		\begin{large}
			\textbf{УДИРТГАЛ}
		\end{large}
	\end{center}
}{\clearpage}

% Acknowledgements environment
\newenvironment{acknowledgements}{
	\begin{center}
		\doublespace
		ТАЛАРХАЛ
	\end{center}
}{\clearpage}

% Dedication page
\newcommand{\dedicationpage}[1]{
	\begin{center}
		\doublespace
		{\itshape #1}
	\end{center}
	\clearpage
}

% Table of contents
\renewcommand{\cftchapdotsep}{1.7}
\renewcommand{\cftchapleader}{\cftdotfill{\cftchapdotsep}}
\renewcommand{\cftpartdotsep}{1.7}
\renewcommand{\cftpartleader}{\cftdotfill{\cftpartdotsep}}
\renewcommand{\cftsecdotsep}{1.7}
\renewcommand{\cftsubsecdotsep}{1.7}
\renewcommand{\cfttabdotsep}{1.7}
\renewcommand{\cftfigdotsep}{1.7}
\renewcommand{\cftchapfont}{\rm}
\renewcommand{\cftpartfont}{\rm}
\renewcommand{\cftchappagefont}{\rm}
\renewcommand{\cftpartpagefont}{\rm}
\cftsetindents{chapter}{1.5em}{1.5em}
\cftsetindents{section}{3.0em}{2.3em}
\cftsetindents{subsection}{5.3em}{3.2em}
\setlength{\cftbeforepartskip}{0truept}
\setlength{\cftbeforechapskip}{0truept}
\setlength{\cftbeforetoctitleskip}{-64.0truept}
\setlength{\cftaftertoctitleskip}{0truept}
\renewcommand{\contentsname}{ГАРЧИГ}
\renewcommand{\cfttoctitlefont}{\hfill\normalsize\rm}
\renewcommand{\cftaftertoctitle}{\hfill}
\newcommand{\cftlabel}{Бүлгүүд}
\renewcommand{\headrulewidth}{0pt}

\renewcommand{\@cfttocstart}{
	\newgeometry{top=1.0in,hmargin=1.25in,height=9.0in,includehead,includefoot,a4paper}
	\doublespace
	\pagestyle{fancyplain}
	\afterpage{\lhead{}\rhead{}}
}

\renewcommand{\@cfttocfinish}{
	\restoregeometry\clearpage\afterpage{\lhead{}\rhead{}}
}

% List of tables
\setlength{\cftbeforelottitleskip}{-64.0truept}
\setlength{\cftafterlottitleskip}{0truept}
\renewcommand{\listtablename}{ХҮСНЭГТИЙН ЖАГСААЛТ}
\renewcommand{\cftlottitlefont}{\hfill\normalsize\rm}
\renewcommand{\cftafterlottitle}{\hfill}

% List of figures
\setlength{\cftbeforeloftitleskip}{-64.0truept}
\setlength{\cftafterloftitleskip}{0truept}
\renewcommand{\listfigurename}{ЗУРГИЙН ЖАГСААЛТ}
\renewcommand{\cftloftitlefont}{\hfill\normalsize\rm}
\renewcommand{\cftafterloftitle}{\hfill}

% Chapter formatting
\def\@chapter[#1]#2{\ifnum \c@secnumdepth >\m@ne
		\refstepcounter{chapter}
		\typeout{\@chapapp\thechapter.}
		\addcontentsline{toc}{chapter}{\protect\numberline{\thechapter.}\uppercase{#1}}
	\else
		\addcontentsline{toc}{chapter}{#1}
	\fi
	\chaptermark{#1}
	\if@twocolumn
		\@topnewpage[\@makechapterhead{#2}]
	\else
		\@makechapterhead{#2}
		\@afterheading
	\fi
}

% Float placement
\setcounter{topnumber}{2}
\setcounter{bottomnumber}{1}
\renewcommand{\topfraction}{0.9}
\renewcommand{\bottomfraction}{0.8}
\renewcommand{\floatpagefraction}{0.7}

% Chapter and section formats
\renewcommand{\@makechapterhead}[1]{
	\begin{huge}
		\noindent \uppercase{\textbf{\thechapter. {#1}}\vspace{0.3\baselineskip}}
	\end{huge}
}
\setcounter{secnumdepth}{2}
\renewcommand{\section}{\@startsection{section}{1}{0in}{1em}{1em}{\raggedright\large\textbf}}
\renewcommand{\subsection}{\@startsection{subsection}{2}{0in}{1em}{1em}{\raggedright\slshape\textbf}}

% Appendix
\renewcommand\appendix{
	\renewcommand{\chaptername}{Хавсралт}
	\setcounter{chapter}{0}
	\setcounter{section}{0}
	\gdef\@chapapp{\appendixname}
	\gdef\thechapter{\@Alph\c@chapter}
	\singlespace
}

% Conclusion
\newcommand\conclusion[1]{
	\newpage
	\addcontentsline{toc}{part}{\uppercase{#1}}
	\begin{huge}
		\textbf{#1}\vspace{\baselineskip}
	\end{huge}
}

% Captions
\renewcommand{\@makecaption}[2]{
	\singlespace
	{\textbf{#1} #2\par}
}

% Footnotes
\setlength{\footnotesep}{\baselineskip}
\let\oldfootnoterule\footnoterule
\def\footnoterule{\oldfootnoterule\vspace{-0.2\baselineskip}}
\let\oldfn\footnote
\renewcommand{\footnote}[1]{\oldfn{#1}\doublespace}

\def\figurename{Зураг}
\def\chaptername{\uppercase{Бүлэг}}